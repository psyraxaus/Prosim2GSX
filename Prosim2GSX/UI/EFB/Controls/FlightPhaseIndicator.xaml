<UserControl x:Class="Prosim2GSX.UI.EFB.Controls.FlightPhaseIndicator"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008" 
             xmlns:local="clr-namespace:Prosim2GSX.UI.EFB.Controls"
             mc:Ignorable="d" 
             d:DesignHeight="100" d:DesignWidth="600">
    <UserControl.Resources>
        <!-- Phase Item Style -->
        <Style x:Key="PhaseItemStyle" TargetType="Border">
            <Setter Property="Background" Value="{DynamicResource PhaseItemBackground}"/>
            <Setter Property="BorderBrush" Value="{DynamicResource PhaseItemBorderBrush}"/>
            <Setter Property="BorderThickness" Value="1"/>
            <Setter Property="CornerRadius" Value="5"/>
            <Setter Property="Padding" Value="10,5"/>
            <Setter Property="Margin" Value="2"/>
            <Setter Property="MinWidth" Value="80"/>
        </Style>
        
        <!-- Phase Item Text Style -->
        <Style x:Key="PhaseItemTextStyle" TargetType="TextBlock">
            <Setter Property="FontSize" Value="12"/>
            <Setter Property="Foreground" Value="{DynamicResource PhaseItemForeground}"/>
            <Setter Property="HorizontalAlignment" Value="Center"/>
            <Setter Property="VerticalAlignment" Value="Center"/>
            <Setter Property="TextAlignment" Value="Center"/>
            <Setter Property="TextWrapping" Value="Wrap"/>
        </Style>
        
        <!-- Active Phase Item Style -->
        <Style x:Key="ActivePhaseItemStyle" TargetType="Border" BasedOn="{StaticResource PhaseItemStyle}">
            <Setter Property="Background" Value="{DynamicResource ActivePhaseItemBackground}"/>
            <Setter Property="BorderBrush" Value="{DynamicResource ActivePhaseItemBorderBrush}"/>
            <Setter Property="BorderThickness" Value="2"/>
        </Style>
        
        <!-- Active Phase Item Text Style -->
        <Style x:Key="ActivePhaseItemTextStyle" TargetType="TextBlock" BasedOn="{StaticResource PhaseItemTextStyle}">
            <Setter Property="FontWeight" Value="Bold"/>
            <Setter Property="Foreground" Value="{DynamicResource ActivePhaseItemForeground}"/>
        </Style>
        
        <!-- Predicted Phase Item Style -->
        <Style x:Key="PredictedPhaseItemStyle" TargetType="Border" BasedOn="{StaticResource PhaseItemStyle}">
            <Setter Property="Background" Value="{DynamicResource PredictedPhaseItemBackground}"/>
            <Setter Property="BorderBrush" Value="{DynamicResource PredictedPhaseItemBorderBrush}"/>
            <Setter Property="BorderThickness" Value="1"/>
            <Setter Property="BorderDashArray" Value="2,2"/>
        </Style>
        
        <!-- Predicted Phase Item Text Style -->
        <Style x:Key="PredictedPhaseItemTextStyle" TargetType="TextBlock" BasedOn="{StaticResource PhaseItemTextStyle}">
            <Setter Property="Foreground" Value="{DynamicResource PredictedPhaseItemForeground}"/>
            <Setter Property="FontStyle" Value="Italic"/>
        </Style>
        
        <!-- Connector Style -->
        <Style x:Key="ConnectorStyle" TargetType="Line">
            <Setter Property="Stroke" Value="{DynamicResource PhaseConnectorStroke}"/>
            <Setter Property="StrokeThickness" Value="2"/>
            <Setter Property="X1" Value="0"/>
            <Setter Property="Y1" Value="0"/>
            <Setter Property="X2" Value="20"/>
            <Setter Property="Y2" Value="0"/>
            <Setter Property="HorizontalAlignment" Value="Center"/>
            <Setter Property="VerticalAlignment" Value="Center"/>
        </Style>
        
        <!-- Active Connector Style -->
        <Style x:Key="ActiveConnectorStyle" TargetType="Line" BasedOn="{StaticResource ConnectorStyle}">
            <Setter Property="Stroke" Value="{DynamicResource ActivePhaseConnectorStroke}"/>
            <Setter Property="StrokeThickness" Value="3"/>
        </Style>
        
        <!-- Predicted Connector Style -->
        <Style x:Key="PredictedConnectorStyle" TargetType="Line" BasedOn="{StaticResource ConnectorStyle}">
            <Setter Property="Stroke" Value="{DynamicResource PredictedPhaseConnectorStroke}"/>
            <Setter Property="StrokeDashArray" Value="2,2"/>
        </Style>
    </UserControl.Resources>
    
    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>
        
        <!-- Phase Items -->
        <StackPanel Grid.Row="0" Orientation="Horizontal" HorizontalAlignment="Center">
            <!-- Preflight -->
            <Border x:Name="PreflightBorder" Style="{StaticResource PhaseItemStyle}">
                <TextBlock x:Name="PreflightText" Text="Preflight" Style="{StaticResource PhaseItemTextStyle}"/>
            </Border>
            
            <!-- Connector -->
            <Line x:Name="PreflightToDepartureConnector" Style="{StaticResource ConnectorStyle}"/>
            
            <!-- Departure -->
            <Border x:Name="DepartureBorder" Style="{StaticResource PhaseItemStyle}">
                <TextBlock x:Name="DepartureText" Text="Departure" Style="{StaticResource PhaseItemTextStyle}"/>
            </Border>
            
            <!-- Connector -->
            <Line x:Name="DepartureToTaxiOutConnector" Style="{StaticResource ConnectorStyle}"/>
            
            <!-- Taxi Out -->
            <Border x:Name="TaxiOutBorder" Style="{StaticResource PhaseItemStyle}">
                <TextBlock x:Name="TaxiOutText" Text="Taxi Out" Style="{StaticResource PhaseItemTextStyle}"/>
            </Border>
            
            <!-- Connector -->
            <Line x:Name="TaxiOutToFlightConnector" Style="{StaticResource ConnectorStyle}"/>
            
            <!-- Flight -->
            <Border x:Name="FlightBorder" Style="{StaticResource PhaseItemStyle}">
                <TextBlock x:Name="FlightText" Text="Flight" Style="{StaticResource PhaseItemTextStyle}"/>
            </Border>
            
            <!-- Connector -->
            <Line x:Name="FlightToTaxiInConnector" Style="{StaticResource ConnectorStyle}"/>
            
            <!-- Taxi In -->
            <Border x:Name="TaxiInBorder" Style="{StaticResource PhaseItemStyle}">
                <TextBlock x:Name="TaxiInText" Text="Taxi In" Style="{StaticResource PhaseItemTextStyle}"/>
            </Border>
            
            <!-- Connector -->
            <Line x:Name="TaxiInToArrivalConnector" Style="{StaticResource ConnectorStyle}"/>
            
            <!-- Arrival -->
            <Border x:Name="ArrivalBorder" Style="{StaticResource PhaseItemStyle}">
                <TextBlock x:Name="ArrivalText" Text="Arrival" Style="{StaticResource PhaseItemTextStyle}"/>
            </Border>
            
            <!-- Connector -->
            <Line x:Name="ArrivalToTurnaroundConnector" Style="{StaticResource ConnectorStyle}"/>
            
            <!-- Turnaround -->
            <Border x:Name="TurnaroundBorder" Style="{StaticResource PhaseItemStyle}">
                <TextBlock x:Name="TurnaroundText" Text="Turnaround" Style="{StaticResource PhaseItemTextStyle}"/>
            </Border>
        </StackPanel>
        
        <!-- Phase Details -->
        <Border Grid.Row="1" 
                Margin="0,10,0,0" 
                Padding="10" 
                Background="{DynamicResource PhaseDetailsBackground}" 
                BorderBrush="{DynamicResource PhaseDetailsBorderBrush}" 
                BorderThickness="1" 
                CornerRadius="5">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>
                
                <!-- Phase Details -->
                <StackPanel Grid.Column="0" Orientation="Vertical">
                    <!-- Current Phase -->
                    <TextBlock Text="{Binding CurrentPhaseText, RelativeSource={RelativeSource AncestorType=local:FlightPhaseIndicator}}" 
                               FontSize="14" 
                               FontWeight="Bold" 
                               Foreground="{DynamicResource PhaseDetailsForeground}"/>
                    
                    <!-- Time in Phase -->
                    <TextBlock Text="{Binding TimeInPhaseText, RelativeSource={RelativeSource AncestorType=local:FlightPhaseIndicator}}" 
                               FontSize="12" 
                               Foreground="{DynamicResource PhaseDetailsForeground}" 
                               Margin="0,5,0,0"/>
                    
                    <!-- Predicted Next Phase -->
                    <TextBlock Text="{Binding PredictedNextPhaseText, RelativeSource={RelativeSource AncestorType=local:FlightPhaseIndicator}}" 
                               FontSize="12" 
                               FontStyle="Italic" 
                               Foreground="{DynamicResource PhaseDetailsForeground}" 
                               Margin="0,5,0,0" 
                               Visibility="{Binding HasPredictedNextPhase, Converter={StaticResource BooleanToVisibilityConverter}, RelativeSource={RelativeSource AncestorType=local:FlightPhaseIndicator}}"/>
                </StackPanel>
                
                <!-- Countdown Timer -->
                <local:CountdownTimer Grid.Column="1" 
                                      x:Name="PredictionCountdown" 
                                      Label="Estimated Time to Next Phase" 
                                      Visibility="{Binding HasEstimatedTimeToNextPhase, Converter={StaticResource BooleanToVisibilityConverter}, RelativeSource={RelativeSource AncestorType=local:FlightPhaseIndicator}}" 
                                      Margin="10,0,0,0"/>
            </Grid>
        </Border>
    </Grid>
</UserControl>
